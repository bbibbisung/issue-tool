진행 패치

✅ 1순위 패치: “왜 이렇게 나왔는지 / 어디를 의심할지” 가시화

목표

결과 화면에 **“진단 카드”**를 하나 더 두고,

RULES vs ML이 어떻게 나왔는지 한눈에 보여주고

둘이 서로 싸우는 상황 / 애매한 상황일 때 **“주의 배지”**를 띄워서

교육생이 “아, 이건 툴이 애매하게 보고 있으니 반드시 내가 체크해야 한다”는 걸 인지하게 만들기.

예상 기능

“결과 진단” 박스에 다음 같은 정보 표시:

충돌 여부: RULES = issue, ML = non_issue (또는 반대)

신뢰도 낮음: issue 확률 · non_issue 확률이 둘 다 60% 근처인 애매한 케이스

기타 카테고리 경고: 카테고리가 “기타”로 나온 케이스

위 조건에 하나라도 걸리면,

주의: 툴 판단이 애매합니다. 체크리스트/프로세스를 기준으로 수동 검토가 필요합니다.
같은 경고 문구 + 노란색 배지.

이 패치를 위해 필요한 파일

app.py

decide_final_label 주변에 “충돌/애매 플래그” 계산 로직 추가

템플릿으로 넘기는 변수(diagnostics 같은 dict) 추가

templates/index.html (index 템플릿 전체)

“2. 최종 판단” 아래에 “2-1. 결과 진단(어디를 의심할지)” 카드 추가

static/styles.css

경고 배지/박스 디자인용 클래스(.badge-warning, .diag-box 등) 추가





✅ 2순위 패치: 이벤트/패스 “기간 종료 + 강한 불만” 케이스 룰 수정

현재 로직은

detect_event_expired_case() +

detect_time_expired_non_issue()

쪽에서 **“기간 종료 = 정상 동작(non_issue)”**에 가깝게 보는 휴리스틱이 강합니다.

“이벤트/패스 기간 종료 관련 문장인데, 유저가 강하게 불만을 표출”
→ 실제로는 운영측 잘못 / 불만 동향으로 취급해야 하는 케이스

를 따로 뽑아내야 합니다.

패치 방향

rules.py 의 detect_event_expired_case() 에서

지금처럼 “기간 종료 + 보상 안 들어옴”을 보고 non_issue로 보내되,

강한 불만/비난 단어가 들어가면 이 함수에서는 non_issue로 분류하지 않게 막기
(→ 이후 일반 룰/카테고리가 issue로 잡게 함)

ml_utils.py 의 detect_time_expired_non_issue()에서도

strong_blame_keywords 리스트를 조금 더 보강해서

“운영 탓/버그 의심/환불 요구”가 들어가는 경우는
time_expired_non_issue = False 로 떨어지도록 조정

이 패치를 위해 필요한 파일

rules.py 전체 최신본

ml_utils.py 전체 최신본

(이미 위에 보내주셨지만, 말씀 주신 대로 **항상 “현재 기준 전체 파일”**을 다시 받아서 패치하겠습니다.)





✅ 3순위 패치: ISSUE / NON ISSUE 배지에 “업무 기준” 연결

지금 배지는 교육생 입장에서 너무 추상적인 YES/NO 느낌이라,

“이게 그냥 모델의 의견인지,
아니면 ‘체크리스트 상으로 이 정도면 보고’라는 의미인지”

감이 안 옵니다.

패치 방향

최종 배지 아래에 짧은 문구를 고정으로 추가:

예)

ISSUE 배지: 체크리스트 기준으로 “인입 3건 이상 시 담당자 공유 권장”에 해당하는 이슈일 가능성이 높습니다.

NON ISSUE 배지: 현재로서는 “즉시 공유가 필요한 이슈”에 해당하지 않을 가능성이 높습니다. 단, 아래 결과 진단/체크리스트를 반드시 함께 확인해 주세요.

프로세스 이미지(체크리스트 스크린샷) 삽입:

FM / NK 선택에 따라

FM 체크리스트 이미지 / NK 체크리스트 이미지 중 하나를 작은 썸네일 + 클릭 시 확대 형식으로 배치

“인입 3건 이상 시 전달” 같은 문구는
실제 체크리스트 이미지 바로 아래에 짧은 텍스트로 다시 써 주기.

이 패치를 위해 필요한 파일

templates/index.html 최신본

static/styles.css 최신본

(이미지 파일 이름은 나중에 정해 주시면 HTML에 <img src="{{ url_for('static', filename='fm_checklist.png') }}"> 식으로 연결할 수 있습니다.)





✅ 4순위 패치: “게임 선택(FM/NK) ↔ 캐릭터 검출” 뒤틀림 방지

말씀하신 대로,
**게임 선택이랑 캐릭터 검출이 꼬이는 건 “절대 있으면 안 되는 버그”**라서,
최소한 다음 정도의 안전장치는 두는 게 좋겠습니다.

패치 방향 (제안)

캐릭터 검출 결과를 보고,

FM을 골랐는데 NK 캐릭터 이름만 가득 나온다거나

반대로 NK인데 FM 캐릭터만 나온다면

결과 상단에 빨간 경고 문구:

주의: 선택한 게임(FM)과 감지된 캐릭터명이 어긋난 것 같습니다. 게임 선택 또는 텍스트 복사 구간을 다시 확인해 주세요.

동시에, 로그에도 suspect_game_mismatch 같은 플래그를 남겨서
나중에 교육자 쪽에서 “입력 실수 vs 룰 문제”를 구분해서 볼 수 있게.

이 패치를 위해 필요한 파일

rules.py 최신본

detect_characters() 결과를 활용해 “어느 게임 캐릭터인지” 체크하는 보조 함수 추가

app.py 최신본

위 보조 함수 호출 후, mismatch일 때 템플릿으로 game_warning 같은 문자열 전달

templates/index.html

game_warning이 있을 때만 붉은 경고 박스 표시




✅ 5순위 패치: 3-2. 피드백 기록 & 다음번 반영 (맨 마지막)

위에서 말씀드린 것처럼 구현 자체는 가능하고,
기능의 중요도도 높지만,
앞선 1~4번 패치로 **기본적인 “해석 가능성 + 안전장치”**를 먼저 깔고 난 뒤에 진행하는 게 안전하다고 생각합니다.

예상 구현 흐름

결과 화면에 작은 폼 추가:

정답 라벨 선택(ISSUE/NON ISSUE)

정확한 카테고리(선택)

나딘 코멘트(텍스트박스)

“피드백 저장” 버튼

app.py에서 이 폼을 처리:

feedback_log.csv에 한 줄씩 추가

분류 로직 앞단에서

텍스트 정규화 → text_hash 계산

feedback_log.csv에서 같은 text_hash가 있으면

final_label, rule_result.category 등을 correct 값으로 교체

화면에 “나딘 피드백 적용” 배지 노출

이 패치를 위해 필요한 파일

app.py 최신본

POST 처리 로직에 피드백 저장/조회 코드 추가

templates/index.html 최신본

결과 섹션에 피드백 입력 폼 추가

static/styles.css 최신본

피드백 박스 스타일

(선택) 나중 재학습을 염두에 둔 feedback_log.csv 컬럼 설계 문서 정도